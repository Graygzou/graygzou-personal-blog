{{ define "breadcrumb" }}
  {{ partial "breadcrumb" . }}
{{ end }}

{{ define "main" }}

  <h1>{{ .Title }}</h1>

  {{- if .InSection .FirstSection -}}
  {{ .Content }}
  <section>
      <!-- Special layout for main posts/_index.html page -->
      {{/* Merge the if into the range with the where do not work properly.. */}}
      {{ $paginator := .Paginate .Pages }}
      {{ range $paginator.Pages }}
        {{ if in site.Params.blogSections (path.Base .Dir) }}
          {{ partial "boxes-section-list" (dict "context" . "fullcontent" false) }}
        {{ end }}
      {{ end }}
  </section>
  {{- else -}}
  <section>
      <!-- Layout for the rest of folders inside posts/ folder -->
      <ul class="basic-list">
        {{ $currentSectionName := .CurrentSection.Name }}
        {{ $pages := (where .Site.RegularPages "Section" "posts") }}
        {{ $paginator := $pages.GroupByPublishDate "2006-01" }}
        {{ range $paginator }}
          <section>
            <h3>{{ .Key }}</h3>
            <ul class="post-list">
              {{ range .Pages }}
                {{ if eq $currentSectionName .Parent.Name }}
                  {{ partial "section-list" (dict "context" . "fullcontent" false) }}
                {{ end }}
              {{ end }}
            </ul>
          </section>
        {{ end }}
      </ul>
  </section>
  {{ end }}
{{ end }}